# Phase 2: Media Generator Application

## Overview

This documentation describes the architecture and implementation plan for the **Media Generator App** - a standalone tkinter-based Python application that processes pending JSON prompts and generates actual media artifacts using ComfyUI workflows.

## Quick Start

### Purpose
The Media Generator App is the second phase of a two-app architecture:

1. **Phase 1** âœ… (Complete): Poets Service generates structured JSON prompts
2. **Phase 2** ðŸ“‹ (This): Standalone app generates actual images/audio from JSON prompts

### What This App Does

```
1. Connects to SQLite database
2. Queries for pending prompts (artifact_status='pending')
3. Displays two lists: Image Prompts | Song Prompts
4. User selects prompts to generate
5. Invokes ComfyUI workflows to create media
6. Saves generated files and updates database
7. Frontend automatically displays new media
```

### Current Status

- âœ… Phase 1 Complete - JSON prompts are being generated by Poets Service
- âœ… Database validated - 4 test prompts ready (3 images, 1 song)
- âœ… Frontend ready - Browse tab already has artifact display capability
- ðŸ“‹ Phase 2 Ready - Architecture documentation complete

### Documentation Structure

Read these documents in order:

1. **[01-System-Architecture.md](01-System-Architecture.md)** - High-level system design
2. **[02-Database-Interface.md](02-Database-Interface.md)** - Database schemas and SQL queries
3. **[03-Data-Models.md](03-Data-Models.md)** - Python data classes
4. **[04-Tkinter-UI-Design.md](04-Tkinter-UI-Design.md)** - UI layout and components
5. **[05-ComfyUI-Integration.md](05-ComfyUI-Integration.md)** - Workflow execution
6. **[06-Configuration.md](06-Configuration.md)** - Configuration file structure
7. **[07-File-Structure.md](07-File-Structure.md)** - Project organization
8. **[08-Integration-Points.md](08-Integration-Points.md)** - Connections to existing systems
9. **[09-Development-Roadmap.md](09-Development-Roadmap.md)** - Implementation milestones
10. **[10-Testing-Guide.md](10-Testing-Guide.md)** - Testing procedures

### Technology Stack

- **UI Framework**: tkinter (Python standard library)
- **Database**: SQLite3
- **Media Generation**: ComfyUI (subprocess execution)
- **Language**: Python 3.8+
- **Dependencies**: Minimal (sqlite3, tkinter, subprocess, pathlib, json)

### Key Features

âœ… **Dual-List Interface** - Separate views for image and song prompts
âœ… **JSON Parsing** - Automatic parsing of structured prompts
âœ… **Progress Feedback** - Real-time status updates during generation
âœ… **Error Handling** - Graceful handling of workflow failures
âœ… **Database Integration** - Automatic artifact tracking
âœ… **No Frontend Changes** - Works with existing Browse tab

### Prerequisites

Before starting Phase 2 implementation:

1. âœ… Phase 1 complete (JSON prompts generating correctly)
2. âœ… Database accessible at `/Volumes/Tikbalang2TB/Users/tikbalang/Desktop/anthonys_musings.db`
3. âœ… ComfyUI installed at `/Volumes/Tikbalang2TB/Users/tikbalang/comfy_env/ComfyUI`
4. âœ… Python environment: `/Volumes/Tikbalang2TB/Users/tikbalang/comfy_env/bin/python`
5. âœ… Workflow scripts exist:
   - Image: `ComfyUI/poets_service/image_workflow.py`
   - Audio: `ComfyUI/poets_service/audio_workflow.py`

### Getting Started

To begin implementation, follow the roadmap in [09-Development-Roadmap.md](09-Development-Roadmap.md):

**Milestone 1**: Core Infrastructure (Data models & repositories)
**Milestone 2**: Tkinter UI (Window, lists, details panel)
**Milestone 3**: ComfyUI Integration (Workflow executors)
**Milestone 4**: End-to-End Testing (Full workflow validation)
**Milestone 5**: Polish & Documentation (Logging, error handling, user guide)

### Support & References

- **Phase 1 Code**: `/Volumes/Tikbalang2TB/Users/tikbalang/poets-service-clean/`
  - `poets_cron_service_v3.py` - JSON prompt generation
  - `tools.py` - Database utilities
  - `poets_cron_config.json` - Configuration

- **Frontend Code**: `/Users/tikbalang/anthonys-musings-web/frontend/static/index.html`
  - Browse tab implementation (lines 2020-2088)
  - Artifact display (lines 2817-2918)
  - Image modal (lines 2114-2193)

- **Database**: SQLite at `/Volumes/Tikbalang2TB/Users/tikbalang/Desktop/anthonys_musings.db`
  - Schema documented in [02-Database-Interface.md](02-Database-Interface.md)

---

**Ready to build the Media Generator App!** ðŸš€
